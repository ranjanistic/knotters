{% extends 'moderation/index.html' %}
{% load custom_tags %}
{% load i18n %}
{% load l10n %}
{% load tz %}

{% block content %}

<div class="w3-row w3-padding" style="background:url('{{moderation.competition.getBanner}}'); background-repeat:no-repeat;background-size:cover">
    <br/>
    <div class="w3-row">
        <div class="w3-col w3-half w3-padding-small">
            <div class="w3-col w3-half w3-padding-small">
                <div class="pallete secondary">
                    <h5 class="text-secondary">{{moderation.competition.title}}</h5>
                    <h6 class="text-secondary">{{moderation.competition.tagline}}</h6>
                    <div class="text-secondary"><strong>{{moderation.competition.shortdescription|truncatechars:120}}</strong></div>
                    <a href="{{moderation.competition.getLink}}#mainframe"><button class="accent small w3-right" data-icon="open_in_new">{% trans "More details" %}</button></a>
                </div>
            </div>
            <div class="w3-col w3-half w3-padding-small w3-center">
                <div class="pallete accent">
                    <h1 class="w3-jumbo">{{moderation.competition.totalJudges}}</h1>
                    <h3>{% trans "Judges in panel" %}</h3>
                </div>
            </div>
        </div>
        <div class="w3-col w3-half w3-padding-small w3-center">
            <div class="w3-col w3-half w3-padding-small">
                <div class="pallete active">
                    <h1 class="w3-jumbo">{{moderation.competition.totalSubmissions}}</h1>
                    <h3>{% trans "Submissions received" %}</h3>
                </div>
            </div>
            <div class="w3-col w3-half w3-padding-small">
                <div class="pallete primary ">
                    <h1 class="w3-jumbo positive-text">{{moderation.competition.totalValidSubmissions }}</h1>
                    <h3 class="positive-text">{% trans "Submissions valid" %}</h3>
                </div>
            </div>
        </div>
    </div>
    <br/>
    <div class="w3-row pallete-slab primary">
    {% if moderation.competition.isHistory %}
        {% if not moderation.resolved %}
            {% if ismoderator %}
                <br/>
                <center><h4 class="dead-text">{% trans "Judges are waiting for submissions to be approved by you." %}</h4></center>
                {% if moderation.competition.totalValidSubmissions > 0 %}
                <div class="w3-row w3-center">
                    <button class="positive big-button" data-icon="upload" id="finalsend">{% trans "Send for judgement" %}</button>
                    <button class="negative big-button"  data-icon="delete" id="discardall">{% trans "Discard all changes" %}</button>
                </div>
                <br/>
                <div class="w3-row">
                    <h6 class="w3-col w3-half">{% trans "Submissions" %} <span class="dead-text"></span></h6>
                    <div class="w3-col w3-half">
                    <button class="small w3-right accent" id="selectall" data-icon="check_box" >{% trans "Select all" %}</button>
                    <button class="small w3-right negative" id="rejectselected" data-icon="close">{% trans "Reject selected" %}</button>
                    <button class="small w3-right positive" id="approveselected" data-icon="done">{% trans "Approve selected" %}</button>
                    </div>
                </div>
                {% endif %}
                {% for sub in moderation.competition.getValidSubmissions %}
                
                <div class="w3-row pallete-slab" id="subslab{{sub.getID}}">
                    <div class="w3-col w3-threequarter">
                        <a><strong class="w3-padding-small members-count-view" data-subID="{{sub.getID}}">{{sub.totalActiveMembers}} <span class="dead-text">member{{sub.totalActiveMembers|pluralize}}</span></strong></a>
                        <strong class="w3-padding-small {% if sub.submitted %}text-tertiary">{% trans "Submitted" %}{% else %}negative-text">{% trans "Un-submitted" %}{% endif %}</strong>
                        {% if sub.submitted %}
                        <strong class="w3-padding-small {% if sub.late %}negative-text">{% trans "late" %}{% else %}text-tertiary">{% trans "on time" %}{% endif %}</strong>
                        at <strong class="w3-padding-small">{{sub.submitOn}}</strong>
                        {% endif %}
                        <button onclick="miniWindow('{{sub.getRepo}}')" class="primary small" data-icon="open_in_new">{% trans "View submission" %}</button>
                    </div>
                        <div class="w3-col w3-quarter w3-center w3-padding">
                        <button class="rejectsubmission negative small" data-subID="{{sub.getID}}" data-subItem="{{sub.getRepo}}" data-icon="cancel" id="reject{{sub.getID}}" >{% trans "Reject" %}</button>
                        <input class="selectsubmission w3-right" data-subID="{{sub.getID}}" data-subItem="{{sub.getRepo}}" id="select{{sub.getID}}" type="checkbox" />
                    </div>
                </div>
                {% empty %}
                <br/>
                <center>
                <i class="w3-jumbo">hourglass_bottom</i>
                <h4>{% trans "No submissions to approve." %}</h4>
                </center>
                {% endfor %}
            {% else %}
                <br/>
                <center>
                <i class="w3-jumbo w3-spin">hourglass_full</i>
                <h1>{% trans "Moderator on duty" %}</h1>
                <h4>{% trans "Please wait while the moderator filters out valid submissions for you to judge." %}</h4><br/>
                <h6 class="positive-text">{% trans "We'll email you as soon as this is done for you." %}</h6>
                </center>
            {% endif %}
        {% else %}
        <br/>
        <div class="w3-row w3-padding">
            {% if moderation.competition.allSubmissionsMarked %}
                {% if moderation.competition.resultDeclared %}
                    <br/>
                    <center>
                    <i class="w3-jumbo positive-text">celebration</i>
                    <h1>{% trans "Results Declared" %} {% trans "." %}</h1>

                    <a href="{% if ismoderator %}{{moderation.competition.getModCertLink}}{% else %}{{moderation.competition.getJudgeCertLink|params:request.user.getID}}{% endif %}"><button class="accent" data-icon="open_in_new">{% trans "Your certificate" %}</button></a>
                    <a href="{{moderation.competition.getLink}}?tab=4"><button class="positive" data-icon="open_in_new">{% trans "See results" %}</button></a>
                    </center>
                {% else %}    
                    <center>
                    <i class="w3-jumbo active-text">verified</i>
                    <h3>{% trans "All submissions have been marked & results are waiting to be declared." %}</h3>
                    <h4>{% trans "Results will be declared by the manager, soon." %}</h4>
                    <h6>{% trans "We'll notify you about the results, once declared." %}</h6>
                    <h6>{% trans "Your certificate of appreciation will also be available, you'll be notified via email about that." %}</h6>
                    </center>
                {% endif %}
            {% else %}
                {% if ismoderator %}
                    <br/>
                    <center>
                    <i class="w3-jumbo w3-spin">hourglass_full</i>
                    <h1>{% trans "Judges on duty" %}</h1>
                    <h4>{% trans "Judges are now marking valid submissions for final ranking." %} {% trans "Thank you for your contribution." %}</h4><br/>
                    <h3>{{moderation.competition.countJudgesWhoMarkedSubmissions}} out of {{moderation.competition.totalJudges}} have marked submissions.</h3>
                    <h6 class="positive-text">{% trans "We'll notify you about the results, once declared." %}</h6>
                    <h6>{% trans "Your certificate of appreciation will also be available, you'll be notified via email about that." %}</h6>
                    </center>
                {% else %}
                    {% if allSubmissionsMarkedByJudge %}
                        <center>
                        <i class="w3-jumbo positive-text">verified</i>
                        <h3>{% trans "All submissions have been marked by you." %}<br/>{% trans "Results will be declared soon." %}</h3>
                        <h4>{% trans "We're grateful to have you as judge in this competition." %} {% trans "Thank you for your contribution." %}</h4>
                        <h6>{% trans "We'll notify you about the results, once declared." %}</h6>
                        <h6>{% trans "Your certificate of appreciation will also be available, you'll be notified via email about that." %}</h6>
                        </center>
                    {% else %}
                        <center><h4 class="dead-text">{% trans "Manager is waiting for submissions to be marked by you." %}</h4></center>
                        <div class="w3-row w3-center">
                            <button class="positive big-button" data-icon="upload" id="finalsend">{% trans "Send for ranking" %}</button>
                            <button class="negative big-button"  data-icon="delete" id="discardall">{% trans "Discard all changes" %}</button>
                        </div>
                        <br/>
                        <h6>Submissions</h6>
                        {% for sub in moderation.competition.getValidSubmissions %}
                        <div class="w3-row pallete-slab" id="subslab{{sub.getID}}">
                            <div class="w3-col w3-padding l4">
                            <strong class="w3-padding">{{sub.totalActiveMembers}} <span class="dead-text">{% trans "member" %}{{sub.totalActiveMembers|pluralize}}</span></strong>
                            <button onclick="miniWindow('{{sub.getRepo}}')" class="primary small" data-icon="open_in_new">{% trans "View submission" %}</button>
                            </div>
                            
                            <div class="w3-col l6">
                            {% for topic in moderation.competition.getTopics %}
                            <div class="w3-col w3-third w3-padding-small">
                            <strong>{{topic.name}}</strong>
                            <input id="{{sub.getID}}{{topic.getID}}" data-subID="{{sub.getID}}" data-topicID="{{topic.getID}}"
                                    class="primary wide w3-padding topic-point point-input-{{sub.getID}}" name="{{sub.getID}}{{topic.getID}}" type="number" min="0" max="{{moderation.competition.eachTopicMaxPoint}}" placeholder="Points out of {{moderation.competition.eachTopicMaxPoint}}" />
                            </div>
                            {% endfor %}
                            </div>
                            <div class="w3-col l2 w3-padding">
                            <button class="small positive save-subpoints" data-icon="done" data-subID="{{sub.getID}}" id="save{{sub.getID}}">{% trans "Save" %}</button>
                            <button class="small negative clear-subpoints" data-icon="close" data-subID="{{sub.getID}}" id="clear{{sub.getID}}">{% trans "Clear" %}</button>
                            </div>
                        </div>
                        {% empty %}
                        <br/>
                        <center>
                        <i class="w3-jumbo">hourglass_bottom</i>
                        <h4>{% trans "No submissions to filter." %}</h4>
                        </center>
                        {% endfor %}
                    {% endif %}
                {% endif %}
            {% endif %}
        </div>
        <br/>
        {% endif %}
    {% elif moderation.competition.isUpcoming %}
        <br/>
        <center>
        <i class="w3-jumbo accent-text">hourglass_top</i>
        <h3>{% trans "Competition will begin at" %}</h3>
        <h1>{{moderation.competition.startAt}}</h1><br/>
        <h4>{% trans "The competion is" %} <span class="accent-text">{% trans "upcoming" %}</span>.</h4>
        <h6 class='dead-text'>You'll be able to {% if ismoderator %}moderate{% else %}judge{% endif %} the submissions after {{moderation.competition.endAt}}</h6>
        </center>
        {% else %}
        <br/>
        <center>
        <i class="w3-jumbo active-text">pending</i>
        <h1 class="w3-jumbo">{{moderation.competition.totalSubmissions}}</h1>
        <h2>{% trans "submissions received" %}</h2><br/>
        <h4>The competion is still <span class="active-text">live</span>.</h4>
        <h6 class='dead-text'>You'll be able to {% if ismoderator %}moderate{% else %}judge{% endif %} the submissions after {{moderation.competition.endAt}}</h6>
        </center>
    {% endif %}
    </div>
<br/>
</div>
{% endblock%}

{% block in_scripts %}
<script>

const ismoderator = "{{ismoderator}}" === 'True';
const allsubsMarked = "{{moderation.competition.allSubmissionsMarked}}" === "True";

if(allsubsMarked){

}else if(!ismoderator){
    let finalData = [];
    const localStorageKey = "{{moderation.getID}}{{moderation.type}}{{request.user.getID}}finalData";
    const eachTopicMaxPoint = Number("{{moderation.competition.eachTopicMaxPoint}}")
    const totalSubmissions = Number("{{moderation.competition.totalValidSubmissions}}")
    const totalTopics = Number("{{moderation.competition.totalTopics}}")
    const previous = window.localStorage.getItem(localStorageKey);
    if(previous){
        try{
            finalData = JSON.parse(previous);
            finalData.forEach((psub)=>{
                psub.topics.forEach((ptopic)=>{
                    getElement(`${psub.subID}${ptopic.topicID}`).value = ptopic.points;
                    getElement(`${psub.subID}${ptopic.topicID}`).disabled = true;
                })
            })
        } catch{
        }
    }

    getElements("clear-subpoints").forEach((clear)=>{
        const subID = String(clear.getAttribute('data-subID')).trim()
        clear.onclick=_=>{
            finalData = finalData.filter((fd)=>fd.subID!=subID)
            getElements(`point-input-${subID}`).forEach((input)=>{
                input.disabled = false
                input.value = '';
            })
            window.localStorage.setItem(localStorageKey, JSON.stringify(finalData))
        }
    })

    getElements("save-subpoints").forEach((save)=>{
        const subID = String(save.getAttribute('data-subID')).trim()
        save.onclick=_=>{
            finalData = finalData.filter((fd)=>fd.subID!=subID)
            finalData.push({
                subID,
                topics:[]
            });
            let added = false
            finalData.some((fd,f)=>{
                if(fd.subID==subID){
                    getElements(`point-input-${subID}`).every((input)=>{
                        if(input.value===""||isNaN(input.value)){
                            input.value = ''
                            error(`Point value cannot be empty.`)
                            input.focus()
                            return false
                        }
                        if(Number(input.value)>eachTopicMaxPoint||Number(input.value)<0) {
                            error(`Points shoud be <=${eachTopicMaxPoint} and >=0.`)
                            input.focus()
                            return false
                        }
                        input.disabled = true
                        const topicID = input.getAttribute('data-topicID');
                        finalData[f].topics = finalData[f].topics.filter((topic)=>topic.id!=topicID)
                        finalData[f].topics.push({
                            topicID,
                            points:Number(input.value)
                        })
                        added = true
                        return true
                    })
                    return true
                }
                return false
            })
            if(!added){
                finalData.pop()
            }
            window.localStorage.setItem(localStorageKey, JSON.stringify(finalData))
        }
    })

    getElement("finalsend").onclick=_=>{
        if(!finalData.length){
            error('{% trans "No submissions marked." %} {% trans "Mark all submissions to send for ranking." %}')
            getElements('topic-point').forEach((input)=>{
                input.disabled = false
            })
            return false
        }
        if(finalData.length!==totalSubmissions){
            getElements('topic-point').some((input)=>{
                if(!input.disabled||input.value===""||isNaN(input.value)
                ||!finalData.find((sub)=>sub.subID==input.getAttribute('data-subID'))){
                    error('{% trans "Please re-fill and save this input." %}')
                    input.disabled = false
                    input.focus()
                    return true
                }
            })
            return false
        }
        
        if(!finalData.every((sub)=>{
            if(sub.topics.length!==totalTopics){
                console.log(sub.subID)
                console.log("yess", getElement(`point-input-${sub.subID}`),getElements(`point-input-${sub.subID}`))
                getElements(`point-input-${sub.subID}`).some((input)=>{
                    console.log("some",sub.topics.some((topic)=>topic.topicID===input.getAttribute('data-topicID')))
                    if(!input.disabled
                        ||input.value===""
                        ||isNaN(input.value)
                        ||sub.topics.some((topic)=>topic.topicID===input.getAttribute('data-topicID'))
                    ){
                        input.disabled = false
                        input.focus()
                        error('{% trans "Please re-fill and save this input." %}')
                        return true
                    }
                })
                return false
            }
            if(sub.topics.some((topic)=>{
                if(Number(getElement(`${sub.subID}${topic.topicID}`).value) !== topic.points){
                    getElement(`${sub.subID}${topic.topicID}`).disabled = false;
                    getElement(`${sub.subID}${topic.topicID}`).focus()
                    error('{% trans "Please re-fill and save this input." %}')
                    return true
                }
                return false
            })){
                return false
            }
            return true
        })){
            return false
        }
        
        alertify.confirm(`{% trans "Send for ranking" %}?`,
        `<h4>{% trans "Are you sure you want to send all marked submissions for final ranking?" %}
            <br/>
            This action is <span class="negative-text">{% trans "irreversible" %}</span>.
        </h4>
        <h6>{% trans "Make sure that every submission is marked properly, as it will determine their final rank results." %}</h6>
        `,
            
        async ()=>{
            message('{% trans "Sending for ranking" %}...')
            loader(true)
            subLoader(true)
            const data = await postRequest("{{moderation.competition.submissionPointsLink}}",{
                submissions: finalData
            });
            if(data.code===code.OK){
                success('{% trans "Submissions marked" %} & {% trans "submitted for ranking" %}.')
                window.location.reload()
            } else {
                loader(false)
                subLoader(false)
                error(data.error);
            }
        },
        ()=>{}
        ).set('labels',{ok:`${Icon('send')}{% trans "Yes" %}, {% trans "send all" %}`, cancel:'{% trans "No" %}, {% trans "wait" %}!'})
    }

    getElement("discardall").onclick=_=>{
        alertify.confirm(`{% trans "Discard changes" %}?`,
        `<h4>{% trans "Are you sure to discard all changes you made?" %} {% trans "All marked submissions will be unmarked, and you'll have to start again" %}!</h4>`,
        ()=>{},
        ()=>{
            subLoader()
            window.localStorage.removeItem(localStorageKey)
            window.location.reload()
        }
        ).set('labels',{ok:`No, wait!`, cancel:`${Icon('delete')}Yes, discard`})
    }
  
}  else {
    const localStorageKey = "{{moderation.getID}}{{moderation.type}}{{request.user.getID}}finalData";
    let allsubmissionchecks = getElements("selectsubmission");
    let selectedAll = false;

    if(Number("{{moderation.competition.totalValidSubmissions}}") > 0){
        let finalData = [];
        getElement("selectall").onclick=_=>{
            allsubmissionchecks.forEach((checkbox)=>{
                checkbox.checked = !selectedAll
                getElement("selectall").innerHTML = selectedAll?`${Icon('check_box')} {% trans "Select All" %}`:`${Icon('check_box_outline_blank')} {% trans "Deselect All" %}`;
            });
            selectedAll = !selectedAll
        }

        getElement('approveselected').onclick=_=>{
            if(!allsubmissionchecks.some((checkbox)=>checkbox.checked)) return error('No submission selected')
            let data = allsubmissionchecks.map((checkbox)=>({
                subID: String(checkbox.getAttribute("data-subID")).trim(),
                valid: checkbox.checked
            }));
            const bulkDialog = alertify.confirm(`{% trans "Confirm bulk operation" %}?`,
                `<h4>Confirm to <span class="positive-text">approve ${data.filter((sub)=>sub.valid).length}</span> submssions and 
                <span class="negative-text">reject ${data.filter((sub)=>!sub.valid).length}</span> submissions?</h4>
                `,()=>{
                    message(`Filtering...`)
                    data.forEach((d)=>{
                        finalData = finalData.filter((fd)=>fd.subID!=d.subID)
                        finalData.push(d)
                        if(!d.valid){
                            allsubmissionchecks = allsubmissionchecks.filter((checkbox)=>checkbox.id!=`select${d.subID}`)
                            hide(getElement(`subslab${d.subID}`))
                        }
                    })
                    window.localStorage.setItem(localStorageKey, JSON.stringify(finalData))
                    message(`Filtered`)
                },()=>bulkDialog.close()).set('labels',{ok:'{% trans "Yes" %}, {% trans "confirm" %}', cancel: '{% trans "No" %}, {% trans "wait" %}!'})
        }
        
        
        getElement('rejectselected').onclick=_=>{
            if(!allsubmissionchecks.some((checkbox)=>checkbox.checked)) return error('No submission selected')
            let data = allsubmissionchecks.map((checkbox)=>({
                subID: String(checkbox.getAttribute("data-subID")).trim(),
                valid: !checkbox.checked
            }));
            const bulkDialog = alertify.confirm(`{% trans "Confirm bulk operation" %}?`,
                `<h4>Confirm to <span class="negative-text">reject ${data.filter((sub)=>!sub.valid).length}</span> submssions and 
                <span class="positive-text">approve ${data.filter((sub)=>sub.valid).length}</span> submissions?</h4>
                `,()=>{
                    message(`{% trans "Filtering" %}...`)

                    data.forEach((d)=>{
                        finalData = finalData.filter((fd)=>fd.subID!=d.subID)
                        finalData.push(d)
                        if(!d.valid){
                            allsubmissionchecks = allsubmissionchecks.filter((checkbox)=>checkbox.id!=`select${d.subID}`)
                            hide(getElement(`subslab${d.subID}`))
                        }
                    })
                    window.localStorage.setItem(localStorageKey, JSON.stringify(finalData))
                    message(`{% trans "Filtered" %}`)
                },()=>bulkDialog.close()).set('labels',{ok:'{% trans "Yes" %}, {% trans "confirm" %}', cancel: '{% trans "No" %}, {% trans "wait" %}!'})
            
        }

        getElements("rejectsubmission").forEach((reject)=>{
            reject.onclick=_=>{
                const rejectDialog = alertify.confirm(`{% trans "Confirm rejection" %}?`,
                `<h4>Confirm to <span class="negative-text">reject</span> the following submission?</h4>
                    <button class="small primary" onclick="miniWindow('${reject.getAttribute("data-subItem")}')">${Icon('open_in_new')}View submission</button>
                `,()=>{
                    message(`rejecting...`)
                    finalData = finalData.filter((fd)=>fd.subID!=reject.getAttribute("data-subID"))
                    finalData.push({
                        subID: reject.getAttribute("data-subID"),
                        valid: false
                    });
                    allsubmissionchecks = allsubmissionchecks.filter((checkbox)=>checkbox.id!=`select${reject.getAttribute("data-subID")}`)
                    window.localStorage.setItem(localStorageKey, JSON.stringify(finalData))
                    hide(getElement(`subslab${reject.getAttribute("data-subID")}`))
                },()=>rejectDialog.close()).set('labels',{ok:'{% trans "Yes" %}, {% trans "reject this one" %}', cancel: '{% trans "No" %}, {% trans "wait" %}!'})
            }
        })

        getElement("finalsend").onclick=_=>{
            if(!finalData.length){
                if(allsubmissionchecks.every((checkbox)=>!checkbox.checked)){
                    finalData = allsubmissionchecks.map((checkbox)=>({
                        subID: String(checkbox.getAttribute("data-subID")).trim(),
                        valid: true
                    }))
                } else {
                    finalData = allsubmissionchecks.map((checkbox)=>({
                        subID: String(checkbox.getAttribute("data-subID")).trim(),
                        valid: checkbox.checked
                    }))
                }
            }
            alertify.confirm(`{% trans "Send to judges" %}?`,
            `<h4>Are you sure you want to send 
                <span class="positive-text">${finalData.filter((fd)=>fd.valid).length} submissions approved</span> by you
                to judges for final evaluation?
                This will also invalidate <span class="negative-text">${finalData.filter((fd)=>!fd.valid).length} submissions rejected</span>
                by you. This action is <span class="negative-text">{% trans "irreversible" %}</span>.
            </h4>`,
            async ()=>{
                message('Submitting...')
                loader(true)
                subLoader(true)
                const data = await postRequest("{{moderation.approveCompeteLink}}",{
                    submissions: finalData   
                });
                if(data.code===code.OK){
                    success('{% trans "Filtered submissions submitted for judgement" %}')
                    window.location.reload()
                } else {
                    loader(false)
                    subLoader(false)
                    error(data.error);
                }
            },
            ()=>{}
            ).set('labels',{ok:'Yes, do it', cancel:'No, wait!'})
        }

        getElement("discardall").onclick=_=>{
            alertify.confirm(`Discard changes?`,
            `<h4>{% trans "Are you sure to discard all changes you made?" %} {% trans "All rejected submissions will be restored, and you'll have to start again." %}</h4>`,
            ()=>{
                subLoader()
                window.localStorage.removeItem(localStorageKey)
                window.location.reload()
            },
            ()=>{}
            ).set('labels',{ok:'Yes, discard', cancel:'No, wait!'})
        }

        const allSubmissionsData = []
        {% for sub in moderation.competition.getValidSubmissions %}
            allSubmissionsData.push({
                subID: "{{sub.getID}}",
                members: [
                    {% for member in sub.getMembers %}
                        {
                            id: "{{member.getUserID}}",
                            name: "{{member.getName}}",
                            email: "{{member.getEmail}}",
                            link: "{{member.getLink}}",
                            dp: "{{member.getDP}}"
                        },
                    {% endfor %}
                ],
            })
        {% endfor %}
        
        getElements("members-count-view").forEach((count)=>{
            count.onclick=_=>{
                const submission = allSubmissionsData.find((subm)=>subm.subID == count.getAttribute("data-subID"))
                let mdata = ''
                submission.members.forEach((member)=>{
                    mdata += `
                    <div class="pallete-slab">
                        <a onclick="miniWindow('${member.link}')"><img src="${member.dp}" class="w3-circle" width="30" /></a>
                        <strong>${member.name}</strong><br/>
                        <span>${member.email}</span>
                    </div>
                    `;
                    
                })
                alertify.alert(`<h6>{% trans "Members View" %} ({% trans "Only to verify authenticity" %})</h6>`, mdata,()=>{})
            }
        })
    }
}
</script>
{% endblock %}
