{% extends 'index.html' %} 
{% load static %}
{% load i18n %}
{% load l10n %}
{% load tz %}
{% load cache %}
{% load custom_tags %}

{% block meta_description %}Time to time mass challenges, targeted primarily on real world problems. And for you to level up with enthusiasm.{% endblock %}
{% block og_url %}{{URLS.COMPETE}}{% endblock %}
{% block og_title %}{% trans "Competitions" %}{% endblock %}
{% block og_description %}Time to time mass challenges, targeted primarily on real world problems. And for you to level up with enthusiasm.{% endblock %}
{% block og_site_name %}{% trans "Competitions" %}{% endblock %}

{% block tw_url %}{{URLS.COMPETE}}{% endblock %}
{% block tw_title %}{% trans "Competitions" %}{% endblock %}
{% block tw_description %}Time to time mass challenges, targeted primarily on real world problems. And for you to level up with enthusiasm.{% endblock %}
{% block tw_site_name %}{% trans "Competitions" %}{% endblock %}

{% block title %}{% trans "Competitions" %}{% endblock %} 
{% block nav_back_show %}{% endblock %}
{% block nav_back_theme %}active{% endblock %}
{% block nav_icon_hide %}{% endblock %}

{% block nav_noauth_competes %}{% endblock %} 
{% block nav_href %}{{URLS.ROOT}}{% endblock %}
{% block nav_text %}Competitions{% endblock %}

{% block nav_extra_links %}
<a href="{{URLS.CERT_INDEX}}"><button title="{% trans "Certification" %}" class="primary" data-icon="qr_code"><span class="w3-hide-small">{% trans "Certification" %}</span></button></a>
{% if request.user.profile.is_manager %}
<a href="{{URLS.Management.CREATE_COMP}}"><button title="{% trans "Create competition" %}" class="active" data-icon="add"><span class="w3-hide-small">{% trans "Create" %}</span></button></a>
{% endif %}
{% endblock %}

{% block content %}
<div class="w3-row w3-padding welcome-row first-time-view" id='compete-intro-banner'
  data-html="
  <br/><br/>
  <div class='w3-row w3-padding'>
  <h1 class='w3-hide-small'>{% trans "Competitions" %}</h1>
  <h2 class='w3-hide-medium w3-hide-large'>{% trans "Competitions" %}</h2>
  </div>
  <br/>
  <div class='w3-row w3-padding'>
  <strong class='text-medium'>
    Time to time mass challenges, targeted primarily on real world problems.<br/>And for you to level up with enthusiasm.
  </strong>
  </div>
  <div class='w3-row w3-padding'>
    <a href='{{URLS.LANDING}}'>
      <button class='positive big-button' data-icon='flight_land'>
        {% trans "Learn More" %}
      </button>
    </a>
    <button class='big-button accent' id='close-compete-intro-banner' data-icon='flight_takeoff'>
        {% trans "I'm ready" %}
    </button>
  </div>">
</div>
<div class="w3-row tertiary" id="mainframe" style="min-height:50vh">
    <div class="w3-row tertiary w3-padding">
        <div class="w3-col w3-quarter w3-padding-small">
        </div>
        <form class="no-auto" id="search-compete-form">
        <div class="w3-col w3-half w3-center w3-padding-small">
            <input class="wide primary" placeholder="{% trans "Search competitions as status:history, topic:Design, or anything" %}" id="browse-search-input" />
        </div>
        <div class="w3-col w3-quarter w3-padding-small" id="browse-search-actions" hidden>
            <button type="button" class="negative w3-right browse-search-compete" data-icon="close" id="browse-search-clear"></button>
            <button type="button" class="positive w3-right browse-search-compete" data-icon="search" id="browse-search-exec"></button>
        </div>
        </form>
    </div>
    <div class="w3-row search-view" data-search-type="licenses" id='browse-search-view'>
    </div>
    <div class="w3-row browser-view" data-type="latest-competitions" id='latest-competitions-view'>
    </div>
  	<div class="w3-row w3-center">
      <button id="active" class="compete-nav-tab big-button href" data-href="#mainframe" data-icon="stream">
        <span class="w3-hide-small">{% trans "Active" %}</span>
      </button>
      <button id="upcoming" class="compete-nav-tab big-button href" data-href="#mainframe" data-icon="hourglass_top">
        <span class="w3-hide-small">{% trans "Upcoming" %}</span>
      </button>
      <button id="history" class="compete-nav-tab big-button href" data-href="#mainframe" data-icon="hourglass_bottom">
        <span class="w3-hide-small">{% trans "History" %}</span>
      </button>
  	</div>
    <div id="tabview" class="w3-row-padding w3-padding-16"></div>
</div>
{% endblock %} 

{% block in_scripts %}
<script>
try{
  getElement("browse-search-clear").onclick=()=>{
    getElement("browse-search-view").innerHTML='';
    hideElement("browse-search-actions");
  }
  getElement("browse-search-input").oninput=(e)=>{
    visibleElement("browse-search-actions", String(e.target.value).trim())
  }
  getElement("browse-search-exec").onclick=async()=>{
    let query = String(getElement("browse-search-input").value).trim();
    if(!query) return message('{% trans "Type something to search competitions" %}')
    const data = await getRequest2({path:URLS.BROWSE_SEARCH,data:{query}})
    if(!data) return
    setHtmlContent(getElement("browse-search-view"),data, loadBrowserSwiper)
  }
  getElement("search-compete-form").onsubmit=(e)=>{
      getElement("browse-search-exec").click();
  }
  if("{{request.GET.search}}"){
    getElement("browse-search-input").value="{{request.GET.search}}";
    showElement("browse-search-actions");
    getElement("browse-search-exec").click()
  }
}catch(e){
  console.log(e)
}
</script>
{% endblock %}
{% block scripts %}
<script src="{% static 'scripts/compete/index.js' %}"  type="text/javascript"></script>
{% endblock %}
