{% extends 'compete/index.html' %} 
{% load static %}
{% load custom_tags %}

{% block meta_description %}{{ compete.shortdescription }}{% endblock %}
{% block og_url %}{{compete.getLink}}{% endblock %}
{% block og_title %}{{ compete.title }}{% endblock %}
{% block og_description %}{{ compete.shortdescription }}{% endblock %}
{% block og_site_name %}{{compete.title}}{% endblock %}
{% block og_image_url %}{{compete.getBanner}}{% endblock %}

{% block ld_image_url %}{{compete.getBanner}}{% endblock %}

{% block tw_image_url %}{{compete.getBanner}}{% endblock %}
{% block tw_url %}{{compete.getLink}}{% endblock %}
{% block tw_title %}{{compete.title}}{% endblock %}
{% block tw_description %}{{ compete.shortdescription }}{% endblock %}

{% block title %}{{ compete.title }}{%endblock %} 

{% block stylesheets %}
<link rel="stylesheet" href="{% static 'styles/compete/profile.css' %}" />
{% endblock %}
{% block nav_back_show %}{% endblock %}
{% block nav_icon_hide %}{% endblock %}

{% block nav_href %}{{ROOT}}{% endblock %} 
{% block nav_text %}{{compete.title}}{% endblock %}
{% block nav_noauth_competes %}{% endblock %} 
{% block content %}
  {% if isJudge or isMod or isManager %}
    <strong>
      <div class="w3-row w3-center accent w3-padding">
        {% if isJudge %}You {% if compete.resultDeclared %}were{% else %}are{% endif %} one of the judges of this competition. <a href="{{compete.getJudgementLink}}" class="underline text-accent">Click here</a> for judgement view.
        {% elif isMod %}You {% if compete.resultDeclared %}were{% else %}are{% endif %} the moderator of this competition. <a href="{{compete.getJudgementLink}}" class="underline text-accent">Click here</a> for moderation view.
        {% elif isManager %}You {% if compete.resultDeclared %}were{% else %}are{% endif %} the manager of this competition. <a href="{{compete.getManagementLink}}" class="underline text-accent">Click here</a> for management view.
        {% endif %}
      </div>
    </strong>
  {% endif %}
<div class="w3-row tertiary">
  <div id="banner">
  <img src="{{compete.getBanner}}" class="preview-type-image" alt="{{compete.title}}" width="100%"/>
  </div>
  {% if compete.isHistory %}
  <div class="w3-row w3-center secondary w3-padding">
    <strong class="text-secondary">This competition is no longer accepting{% if not compete.resultDeclared %} new{% endif %} submissions.</strong>
  </div>
  {% elif compete.isUpcoming %}
  <div class="w3-row w3-center accent w3-padding">
    <strong>This competition will accept submissions from the given beginning date, till {{compete.endAt}}</strong>
  </div>
  {% endif %}
  <div class="w3-row w3-padding">
    <br/>
    <div class="w3-row">
      <div class="w3-col w3-twothird w3-left w3-padding">
        <div class="w3-col {% if compete.associate or compete.reg_fee %}w3-half{% endif %}">
        <h2>{{compete.title}}</h2>
        <h4>{{compete.tagline}}</h4>
        <strong>{{compete.shortdescription}}
        </strong>
        <br/><br/>
        <button class="small navigator-share-action accent" data-icon="share" data-title="{{compete.title}}" data-text="Checkout {{compete.title}} competition at {{APPNAME}}!" data-url="{{compete.getLink}}">Share</button>
        </div>
        {% if compete.associate %}
        <div class="w3-col w3-half w3-center dead-text w3-padding">
          <h4>In association with </h4>
          <img class="pallete preview-type-image" src="{{compete.get_associate}}" width="80%" />
        </div>
        {% endif %}
        {% if request.user.is_authenticated and not isJudge and not isMod and not isManager %}
        {% if compete.reg_fee and not compete.isHistory %}
        <div class="w3-col w3-half w3-center dead-text w3-padding">
          <h4>To be eligible for prizes,</h4>
          <div class="razorpay-embed-btn" data-url="https://pages.razorpay.com/pl_IPZ86a6xkiVXuU/view" data-text="Pay Registration Fee" data-color="#F5D702" data-size="medium">
            <script>
              (function(){
                var d=document; var x=!d.getElementById('razorpay-embed-btn-js')
                if(x){ var s=d.createElement('script'); s.defer=!0;s.id='razorpay-embed-btn-js';
                s.src='https://cdn.razorpay.com/static/embed_btn/bundle.js';d.body.appendChild(s);} else{var rzp=window['__rzp__'];
                rzp && rzp.init && rzp.init()}})();
            </script>
          </div>
        </div>
        {% endif %}
        {% endif %}
      </div>
      <div class="w3-col w3-third w3-center w3-padding">
      <br/>
        {% if compete.isActive %}
        <div class="pallete pointer" id="reload-time">
          <h6>Remaining</h6>
          <h1 id="remainingTime"><div class="loader"></div></h1>
          <h6>To submit</h6>
        </div>
        {% elif compete.isHistory %}
        <div class="pallete secondary">
          <h6 class="text-secondary">Competition ended</h6>
          <h1 class="text-secondary">{{compete.endAt}}</h1>
          <h6 class="text-secondary">{% if compete.resultDeclared %}Archived{% else %}Results Awaited{% endif %}</h6>
        </div>
        {% elif compete.isUpcoming %}
        <div class="pallete accent">
          <h6>Begins at</h6>
          <h1>{{compete.startAt}}</h1>
          <h6>Upcoming</h6>
        </div>
        {% endif %}
      </div>
    </div>
    <br/><br/>
      {% if compete.isUpcoming %}
        <br/>
        <center>
        <i class="w3-jumbo">lock</i>
        <h3>Stay Tuned!</h3>
        <h4>Full details will be shown<br/>once the competition begins.</h4>
        <h5>In the meantime, go through our <a href="{{URLS.Docs.TYPE|params:'competitionguidelines'}}" target="_blank">competition guidelines</a>.</h5>
        </center>
        <br/>
      {% else %}
    <div class="w3-row pallete" id="mainframe">
      <div class="w3-col w3-quarter">
        <div class="w3-bar-block w3-hide-small" id="sidebar">
          <button class="w3-bar-item side-nav-tab" id="overview" data-id="overview" data-icon="toc">Overview</button>
          <button class="w3-bar-item side-nav-tab" id="task" data-id="task" data-icon="code">Task</button>
          <button class="w3-bar-item side-nav-tab" id="guidelines" data-id="guidelines" data-icon="rule">Guidelines</button>
          {% if not isJudge and not isMod and not isManager %}
          <button class="w3-bar-item side-nav-tab" id="submission" data-id="submission" data-icon="send">Submission</button>
          {% endif %}
          {% if compete.isHistory %}
          <button class="w3-bar-item side-nav-tab" id="result" data-id="result" data-icon="leaderboard">Results</button>
          {% endif %}
        </div>
        <div class="w3-center w3-hide-large w3-hide-medium">
          <button class="side-nav-tab-small" id="overview-small" data-id="overview" data-icon="toc"></button>
          <button class="side-nav-tab-small" id="task-small" data-id="task" data-icon="code"></button>
          <button class="side-nav-tab-small" id="guidelines-small" data-id="guidelines" data-icon="rule"></button>
          {% if not isJudge and not isMod and not isManager %}
          <button class="side-nav-tab-small" id="submission-small" data-id="submission" data-icon="send"></button>
          {% endif %}
          {% if compete.resultDeclared %}
          <button class="side-nav-tab-small" id="result-small" data-id="result" data-icon="leaderboard"></button>
          {% endif %}
        </div>
      </div>

      <div class="w3-col w3-threequarter w3-padding">
        <br/>
        <div id="tabview">
        
        </div>
      </div>
    </div>
      {% endif %}

    <br/>
  </div>
  {% if not compete.isUpcoming %}
  <div class="w3-row w3-padding" id="notice">
    <strong>
    <center>*NOTICE</center><br/>
    - All mentioned prizes & perks for rank holders are the sole resposibility of <a href="{{compete.creator.getLink}}" target="_blank">the manager</a>. 
    Under no circumstances {{APPNAME}} and its administrators must be held accountable for any discrepancies. {{APPNAME}} support team however, may try to help you in such cases, but only if you want their help.<br/>
    - If participating in a group, the rank perk/prize will be awarded to the group as a unit. No distribution of prize among the members of submission will be felicitated by {{APPNAME}}.<br/>
    - The chance to level up profile by the mentioned XP amount is totally conditional. Actual XP amount most certnainly will vary for every participant, depending upon the points they earn.<br/>
    - The submissions made to this competition should follow our <a href="{{URLS.Docs.TYPE|params:'competitionguidelines'}}" target="_blank">competition guidelines</a>, and the guidelines mentioned above. In case of guideline conflict, the former shall prevail.<br/>
    - The decision of the jury will be considered final, and the jury, {{APPNAME}} and its administrators shall not be accountable for challenge by any participant under any circumstances regarding the declared results.<br/>
    - Results for this competition will only be declared & available here. Declaration of results could take time, after the competition ends. Participants are advised to not fall for any fake result announcements, and should check the result status on this page only.<br/>
    - Participants, judges, & moderator will be notified via our official channels (email, discord announcement) only, once the results are declared.
    - After the declaration of results, the certificate URL will be available alongside the rank of a participant. That URL should be considered of equal weightage as of the e-certificate.<br/>
    - Issuing of e-certificate by {{APPNAME}} for every participant could take time, after the results declaration. However, the certificate URL will remain valid & available all the time.<br/>
    - E-certificate issued by {{APPNAME}}, which will be available on the certificate URL, should only be considered valid. Any certificate issued to participant apart from that via any other source should be considered fraud, and must be reported to us.<br/>
    - The XP will be available to claim for every participant. Each participant can claim only their own XP from a competition.<br/>
    - After claiming XP, the topic(s) of this competition and their individual earned points will not get mentioned on participant's profile automatically. Participants can add topics to their own profiles by themselves, if they want to.<br/>
    - For other doubts or concerns, you may refer our <a href="{{URLS.DOCS}}" target="_blank">legal & moral section</a>.
    </strong>
  </div>
  {% endif %}
    <br/>
</div>

{% endblock %}
{% block in_scripts %}
<script>
const compID = "{{compete.getID}}"
const isActive = "{{compete.isActive}}" == 'True';
const resultDeclared = "{{compete.resultDeclared}}" == 'True';
const tabindex = Number("{{request.GET.tab}}") || false;
if(tabindex){window.location.href="#mainframe"}
</script>
{% endblock %} 
{% block scripts %}
<script src="{% static 'scripts/compete/profile.js' %}" type="text/javascript"></script>
{% endblock %} 
