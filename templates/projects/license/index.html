{% extends 'projects/index.html' %}
{% load static %}
{% load i18n %}
{% load l10n %}
{% load tz %}
{% load cache %}
{% load custom_tags %}

{% block og_url %}{{URLS.ALLLICENSES}}{% endblock %}
{% block og_title %}Licenses{% endblock %}
{% block og_description %}Licenses for licenses{% endblock %}
{% block og_site_name %}Licenses{% endblock %}

{% block tw_url %}{{URLS.ALLLICENSES}}{% endblock %}
{% block tw_title %}Licenses{% endblock %}
{% block tw_description %}Licenses for licenses{% endblock %}

{% block title%}Licenses{%endblock%}

{% block nav_text %}Licenses{% endblock %}
{% block nav_href %}{{URLS.PROJECTS}}{% endblock %}

{% block nav_noauth_licenses %}{% endblock %}

{% block content %}
<br/>
<div class="w3-row">
    <div class="w3-row tertiary w3-padding">
        <div class="w3-col w3-quarter w3-padding-small">
        </div>
        <div class="w3-col w3-half w3-center w3-padding-small">
            <input class="wide primary" placeholder="Type to search for licenses" id="browse-search-input" />
        </div>
        <div class="w3-col w3-quarter w3-padding-small" id="browse-search-actions" hidden>
            <button class="negative w3-right browse-search-licenses" data-icon="close" id="browse-search-clear"></button>
            <button class="positive w3-right browse-search-licenses" data-icon="search" id="browse-search-exec"></button>
        </div>
    </div>
    <div class="w3-row search-view" data-search-type="licenses" id='browse-search-view'>
    </div>
</div>
<div class="w3-row w3-padding">
    {% if custom.0 %}
    <center><h4>Your private custom licenses</h4></center>
    <br/>
    <div class="w3-row">
    {% cache CACHE_MICRO private_licenses request.user.id %}
    {% for license in custom %}
        <div class="w3-col w3-half w3-padding-small">
        <div class="w3-row pallete-slab">
        <h4>{{license}}</h4>
        <strong>{{license.description}}</strong>
        <a href="{{license.getLink}}" class="w3-right"><button class="primary">View</button></a>
        </div>
        </div>
    {% endfor%}
    {% endcache %}
    </div>
    {% endif %}
    <br/>
    <center><h4>Public licenses</h4></center>
    <br/>
    <div class="w3-row">
    {% cache CACHE_SHORT public_licenses %}
    {% for license in licenses %}
        <div class="w3-col w3-half w3-padding-small">
        <div class="w3-row pallete-slab">
        <h4>{{license}}</h4>
        <strong>{{license.description}}</strong>
        <a href="{{license.getLink}}" class="w3-right"><button class="primary">View</button></a>
        </div>
        </div>
    {% endfor%}
    {% endcache %}
    </div>
</div>
<br/>

{% endblock %}
{% block scripts %}
<script>
try{
getElement("browse-search-clear").onclick=()=>{
  getElement("browse-search-view").innerHTML='';
  hideElement("browse-search-actions");
}
getElement("browse-search-input").oninput=(e)=>{
  visibleElement("browse-search-actions", String(e.target.value).trim())
}
getElement("browse-search-exec").onclick=async()=>{
  let query = String(getElement("browse-search-input").value).trim();
  if(!query) return message('Type something to search licenses')
  const data = await getRequest(URLS.LICENSE_SEARCH,{query})
  if(!data) return
  setHtmlContent(getElement("browse-search-view"),data, loadBrowserSwiper)
}
}catch(e){
  console.log(e)
}
</script>
{% endblock %}