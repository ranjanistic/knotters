{% load static %}
{% load i18n %}
{% load l10n %}
{% load tz %}
{% load cache %}
{% load custom_tags %}

{% if sections or self %}
    <div class="parent-sidenav" id="sidenav-menu">
        <div class="sidenav-small w3-hide-large w3-hide-medium w3-animate-left tertiary w3-center w3-padding text-medium">
            <div class="w3-row w3-left align text-primary">
                <i class="w3-xlarge material-icons text-primary" id="closenav">close</i>
            </div>
            <div id="sidenav-view">
                {% if self %}
                    <div class="w3-row align w3-padding">
                        {% if article.is_draft%}
                            <button id="publishArticle" class="accent w3-large w3-animate-zoom">
                                Publish Article
                            </button>
                        {% endif %}
                        <button id="deleteArticle" class="negative w3-large w3-animate-zoom" type="submit">Delete Article</button> 
                    </div>
                {% endif %}
                <br />
                {% for section in sections %}
                <div class="w3-row">
                    <a class="text-primary" href="#view-section-{{ section.id }}">
                        <strong>{{section.subheading}}</strong>
                    </a>
                </div>
                <br />
                {% endfor %}
            </div>
            {% if self and article.isEditable %}
                <div id="sidenav-edit" hidden>
                    {% for section in sections %}
                        <div class="w3-row">
                            <div class="w3-col s10 m10 l10">
                                <div class="section-edit" sectionid="{{ section.id }}">
                                    <input type="text" class="primary w3-input subheading" name="subheading" placeholder="Subheading" value="{{section.subheading}}"/>
                                </div>
                            </div>
                            <div class="w3-col s2 m2 l2">
                                <button class="small w3-right negative" id='delete-section-{{ section.id }}' data-icon='delete'></button>  
                            </div>   
                        </div>
                        <br />
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>
{% endif %}
<div class="w3-row section-body">
    {% if sections or self %}
        <div class="sidenav w3-hide-small tertiary w3-center w3-padding text-medium">
            <div id="sidenav2-view">
                {% if self %}
                    <div class="w3-row align w3-padding">
                        {% if article.is_draft%}
                            <button id="draftArticle" class="accent w3-large w3-animate-zoom">
                                Publish Article
                            </button>
                        {% endif %}
                        <button id="deleteArticle" class="negative w3-large w3-animate-zoom" type="submit">Delete Article</button> 
                    </div>
                {% endif %}
                <br />
                {% for section in sections %}
                <div class="w3-row">
                    <a class="text-primary" href="#view-section-{{ section.id }}">
                        <strong>{{section.subheading}}</strong>
                    </a>
                </div>
                <br />
                {% endfor %}
            </div>
            {% if self and article.isEditable %}
                <div id="sidenav2-edit" hidden>
                    {% for section in sections%}
                    <div class="w3-row">
                        <div class="w3-col s10 m10 l10">
                            <div class="section-edit section-elements" sectionid="{{ section.id }}" hasImage="{%if section.image %}true{% else %}false{% endif %}">
                                <input type="text" class="primary w3-input subheading" name="subheading" placeholder="Subheading" value="{{section.subheading}}"/>
                            </div>
                        </div>
                        <div class="w3-col s2 m2 l2">
                            <button class="small w3-right negative" id='delete-section-{{ section.id }}' data-icon='delete'></button>  
                        </div>   
                    </div>
                    <br />
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    {% endif %}
    <div class="sections">
        <i class="w3-padding w3-hide-large w3-hide-medium" id="opennav">menu</i>
        <div id="section-body-view">
            {% for section in sections %}
                <div class="w3-row">
                    <div class="w3-row w3-padding" id="view-section-{{section.id}}" sectionid="{{section.id}}">
                        {% if section.paragraph %}
                        <span class="text-tertiary text-medium ">{{section.paragraph}}</span><br/>
                        {% endif %}
                        <div class="w3-row w3-center" style="padding-bottom:1rem">
                            {% if section.image %}
                            <img class="primary " src="{{ section.get_image }}"/>
                            <br/>
                            {% endif %}
                            {% if section.video %}
                            <video src="{{section.get_video}}" width="40%" controls></video>
                            <br/>
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                </div>
                {% empty %}
                    <h5 class="dead-text align ">{% trans "No Sections Yet" %}</h5>
            {% endfor %}
        </div>

        {% if self and article.isEditable %}
            <div id="section-body-edit" hidden>
                <div class="w3-row" id="section-edit-inputs">
                    {% for section in sections %}
                        {% if self and article.isEditable%}
                        <div class="w3-row w3-padding">
                            {% if section.paragraph %}
                            <div class="section-edit" sectionid="{{ section.id }}">
                                <textarea class="wide paragraph" name='paragraph' rows="3" placeholder="paragraph">{{ section.paragraph }}</textarea>
                            </div>
                            {% endif %}
                            {% if section.image %}
                                <input type='file' hidden id='section-file-{{section.id}}' accept="image/png, image/jpg, image/jpeg"/>
                                <div class="w3-center">
                                    <img class="primary" src="{{ section.get_image }}" alt="{{ section.subheading }}" id="imageOutput-{{section.id}}" style="opacity:0.5" />
                                </div>
                                <div class="dead-text w3-center w3-padding" id='add-image-view-{{section.id}}'>
                                    <button type="button" class="small accent" data-icon="upload">
                                        <label for="section-file-{{section.id}}">Update Image</label>
                                    </button>
                                </div>
                                <div class="section-edit" sectionid="{{ section.id }}">
                                    <input type="text" class="image" id='imageData-{{section.id}}' name='image' hidden value="">
                                    <input hidden type="checkbox" id="event-{{section.id}}">
                                </div>
                            {% endif %}
                            {% if section.video %}
                                <input type='file' hidden id='section-video-file-{{section.id}}' accept="video/mp4 video/ogg"/>
                                <div class="w3-center">
                                    <video controls class="primary" src="{{ section.get_video }}" id="videoOutput-{{section.id}}">
                                        Your browser does not support the video playback.
                                    </video>
                                </div>
                                <div class="dead-text w3-center w3-padding" id='add-video-view-{{section.id}}'>
                                    <button type="button" class="small accent" data-icon="upload">
                                        <label for="section-video-file-{{section.id}}">Update Video</label>
                                    </button>
                                </div>
                                <div class="section-edit" sectionid="{{ section.id }}">
                                    <input type="text" class="video" id='videoData-{{section.id}}' name='video' hidden value="">
                                    <input hidden type="checkbox" id="event-{{section.id}}">
                                </div>
                            {% endif %}
                        </div>
                        {% endif %}
                        <br/>
                        {% empty %}
                        <h5 class="dead-text align ">{% trans "No Sections Yet" %}</h5>
                    {% endfor %}
                </div>
                <div class="w3-row">
                    <div class="w3-center">
                        <button id="add-paragraph" class="small w3-padding w3-margin" data-icon="add">
                            Add Paragraph
                        </button>
                        <button id="add-image" class="small w3-padding w3-margin" data-icon="add">
                            Add Image
                        </button>
                        <button id="add-video" class="small w3-padding w3-margin" data-icon="add">
                            Add Video
                        </button>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</div>


